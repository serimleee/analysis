
# date_format
SELECT A.TITLE
,A.BOARD_ID
,B.REPLY_ID
,B.WRITER_ID
,B.CONTENTS
,DATE_FORMAT(B.CREATED_DATE,'%Y-%m-%d') CREATED_DATE
FROM USED_GOODS_BOARD A
INNER JOIN USED_GOODS_REPLY B ON A.BOARD_ID = B.BOARD_ID
WHERE 1=1
AND A.CREATED_DATE BETWEEN '2022-10-01' AND '2022-10-30'
ORDER BY B.CREATED_DATE, A.TITLE
;

# 오름차순, 내림차순 정렬 확인하기
SELECT USER_ID, PRODUCT_ID
FROM ONLINE_SALE
GROUP BY 1,2
HAVING COUNT(DISTINCT SALES_DATE)>=2
ORDER BY 1,2 DESC

# date_format 신경쓰기
SELECT A.*
FROM 
(SELECT DATE_FORMAT(SALES_DATE,'%Y-%m-%d') SALES_DATE, PRODUCT_ID, USER_ID, SALES_AMOUNT
FROM ONLINE_SALE
WHERE SALES_DATE BETWEEN '2022-03-01' AND '2022-03-31'
UNION 
SELECT DATE_FORMAT(SALES_DATE,'%Y-%m-%d') SALES_DATE, PRODUCT_ID, NULL AS USER_ID, SALES_AMOUNT
FROM OFFLINE_SALE
WHERE SALES_DATE BETWEEN '2022-03-01' AND '2022-03-31'
) A
ORDER BY SALES_DATE, PRODUCT_ID, USER_ID

# 값 필터링
SELECT ANIMAL_ID, NAME
FROM ANIMAL_INS
WHERE INTAKE_CONDITION = 'Sick'
ORDER BY 1

# 문제 제대로 읽기
SELECT ANIMAL_ID, NAME
FROM ANIMAL_INS
WHERE INTAKE_CONDITION != 'Aged'
ORDER BY 1

# CASE WHEN
SELECT BOARD_ID
, WRITER_ID
, TITLE
, PRICE
, CASE WHEN STATUS='SALE' THEN '판매중'
WHEN STATUS='RESERVED' THEN '예약중'
WHEN STATUS='DONE' THEN '거래완료'
ELSE NULL END AS STATUS
FROM USED_GOODS_BOARD
WHERE 1=1 
AND CREATED_DATE = '2022-10-05'
ORDER BY BOARD_ID DESC

# WHERE IN
SELECT ANIMAL_ID, NAME, SEX_UPON_INTAKE
FROM ANIMAL_INS
WHERE 1=1
AND NAME IN ('Lucy','Ella','Pickle','Rogan','Sabrina','Mitty')

# 아니 animal_type = dog 를 넣어야함
SELECT ANIMAL_ID, NAME
FROM ANIMAL_INS
WHERE 1=1
AND UPPER(NAME) LIKE '%EL%'
AND ANIMAL_TYPE = 'Dog'
ORDER BY NAME

# RLIKE
SELECT ANIMAL_ID, NAME
,CASE WHEN  SEX_UPON_INTAKE RLIKE 'Neutered|Spayed' THEN 'O'
ELSE 'X' END AS SEX_UPON_INTAKE
FROM ANIMAL_INS
ORDER BY ANIMAL_ID

# 경과일수는 DATEDIFF
SELECT A.ANIMAL_ID
, A.NAME
FROM ANIMAL_OUTS A
INNER JOIN ANIMAL_INS B ON A.ANIMAL_ID = B.ANIMAL_ID
ORDER BY DATEDIFF(A.DATETIME,B.DATETIME) DESC
LIMIT 2

# date_format
SELECT ANIMAL_ID, NAME, DATE_FORMAT(DATETIME,'%Y-%m-%d') DATETIME
FROM ANIMAL_INS
ORDER BY ANIMAL_ID

# CONCAT, 문제이해, 정렬
SELECT CONCAT('/home/grep/src/',A.BOARD_ID,'/',FILE_ID,FILE_NAME,FILE_EXT) FILE_PATH
FROM 
    (SELECT BOARD_ID
    FROM USED_GOODS_BOARD
    ORDER BY VIEWS DESC
    LIMIT 1) A
INNER JOIN USED_GOODS_FILE B ON A.BOARD_ID=B.BOARD_ID
ORDER BY 1 DESC

# CONCAT, SUBSTRING, 문제 잘 읽기 CITY
SELECT A.USER_ID
, A.NICKNAME
, CONCAT(CITY,' ',A.STREET_ADDRESS1,' ',A.STREET_ADDRESS2) 전체주소
, CONCAT(SUBSTRING(A.TLNO,1,3),'-', SUBSTRING(A.TLNO,4,4),'-',SUBSTRING(A.TLNO,8,4)) 전화번호
FROM USED_GOODS_USER A
INNER JOIN 
    (SELECT WRITER_ID
    FROM USED_GOODS_BOARD
    GROUP BY 1
    HAVING COUNT(BOARD_ID)>=3) B ON A.USER_ID = B.WRITER_ID
ORDER BY A.USER_ID DESC

# GROUP BY HAVING
SELECT A.USER_ID, A.NICKNAME, B.TOTAL_SALES
FROM USED_GOODS_USER A
INNER JOIN 
    (SELECT WRITER_ID, SUM(PRICE) TOTAL_SALES
    FROM USED_GOODS_BOARD
    WHERE 1=1 
    AND STATUS = 'DONE'
    GROUP BY 1
    HAVING SUM(PRICE)>=700000) B ON A.USER_ID = B.WRITER_ID
ORDER BY B.TOTAL_SALES

# 조회
SELECT ANIMAL_TYPE, COUNT(DISTINCT ANIMAL_ID) COUNT
FROM ANIMAL_INS
GROUP BY 1
ORDER BY 1

# LIKE
SELECT *
FROM CAR_RENTAL_COMPANY_CAR
WHERE 1=1
AND OPTIONS LIKE '%네비게이션%'
ORDER BY CAR_ID DESC
